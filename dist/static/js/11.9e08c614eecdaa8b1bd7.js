webpackJsonp([11],{HXef:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("lC5x"),n=a.n(r),s=a("3cXf"),o=a.n(s),i=a("J0Oq"),c=a.n(i),u=a("zSLJ"),l=(a("jCZR"),a("NFfb")),d=a("BK/k"),m=a("sD4o"),h=a("wYMm"),p=(a("dK8a"),a("dQe3")),f=Object(d.d)(),v={data:function(){return{dialogFormVisible:!1,isRest:!1,ruleForm:{Account:"",Password:"",checked:""},loading:!1,loginFlag:!0,checkTokenTimer:"",userInfo:"",menu:[]}},created:function(){var t=this;return c()(n.a.mark(function e(){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.userInfo=JSON.parse(localStorage.getItem(l.l)),t.menu=JSON.parse(localStorage.getItem(l.g)),localStorage.setItem(l.m,o()(Object(u.a)(l.m))),t.getCurrentUserMenuTree(),a=6e4,r=30,t.checkTokenTimer=setInterval(function(){t.checkToken(r)&&t.Refeshtoken2Accesstoken()},a);case 7:case"end":return e.stop()}},e,t)}))()},computed:{TrueName:function(){return this.userInfo&&this.userInfo.TrueName},CardImgUrl:function(){return this.userInfo&&this.userInfo.CardImgUrl}},methods:{Refeshtoken2Accesstoken:function(){var t=this;return c()(n.a.mark(function e(){var a,r,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Object(u.a)(l.i)){e.next=3;break}return e.abrupt("return");case 3:return r={refreshtoken:a,appid:h.a},e.next=6,t.$http.getAccessToken(r);case 6:0===(s=e.sent).status&&Object(m.a)(l.j,s.result,2);case 8:case"end":return e.stop()}},e,t)}))()},checkToken:function(t){var e=Object(u.a)(l.j).split(".")[1],a=JSON.parse(p.Base64.decode(e)).exp,r=(new Date).getTime();return parseInt(a)-parseInt(r/1e3)<=60*t},clickRouter:function(t){for(var e in this.menu)if(t.NavigationId==this.menu[e].NavigationId){if(this.menu[e].Url.indexOf("http")>-1){var a=this.menu[e].Path,r=this.menu[e].Url;console.log(a),this.openPages(a,r)}else{if(!t.isAuth)return this.stopHalt();this.updateCurrentMenu(this.menu[e])}return}},openPages:function(t,e){console.log(e);var a=Object(u.a)(f+"GDSID"),r=Object(u.a)(l.j),n={appId:t,GDSID:a},s=this;$.ajax({url:Object(d.c)()+"apigateway.gaodun.com/saas-service/menu/child",type:"GET",async:!1,data:n,headers:{Authentication:"Basic "+r,"Content-Type":"application/json"},dataType:"json",success:function(t,a,r){if(t&&t.status>553649e3&&t.status<563649999)return localStorage.clear(),void(location.href=h.b);0==t.status?window.open(e):101==t.status&&s.$message({message:"您暂未开通权限！"})},error:function(t,e){},complete:function(){}})},checkRouterPath:function(t){for(var e in t)if(t[e].isAuth){if(!t[e].ChildNavigations)return t[e].Url;if(t[e].ChildNavigations)return this.checkRouterPath(t[e].ChildNavigations)}},updateCurrentMenu:function(t){var e=this;if(t.ChildNavigations){var a=t.ChildNavigations,r=this.checkRouterPath(a);if(0==parseInt(r))return this.stopHalt();var n=r;this.$router.push({path:r}),setTimeout(function(){e.$store.dispatch("updateCurrentTabId",n)},0)}else this.afterFunction()},afterFunction:function(){this.$message({message:"后续功能正在开发中~~"})},stopHalt:function(){this.$message({message:"您暂未开通权限！"})},handleCommands:function(t){var e=this;return c()(n.a.mark(function a(){var r,s,o;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=Object(d.d)(),"logout"!=t){a.next=9;break}return s={appid:h.a,token:Object(u.a)(l.j)},a.next=5,e.$http.userLogout(s);case 5:0==a.sent.status&&((o=new Date).setTime(o.getTime()-1),Object(m.a)(l.j,void 0,-1),Object(m.a)(l.i,void 0,-1),Object(m.a)(l.m,void 0,-1),Object(m.a)(r+"GDSID",void 0,-1),localStorage.clear(),e.$store.state.navigation.currentLevelOneId=9,location.href=h.b),a.next=10;break;case 9:case 10:case"end":return a.stop()}},a,e)}))()},getCurrentUserMenuTree:function(){var t=this;return c()(n.a.mark(function e(){var a,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(u.a)(f+"GDSID"),e.next=3,t.$http.getCurrentUserMenuTree({appId:h.a,GDSID:a});case 3:0===(r=e.sent).status&&(t.reWriteEmptyUrl(r.result.Tpo_Sys_Navigations),localStorage.setItem(l.g,o()(r.result.Tpo_Sys_Navigations)),localStorage.setItem(l.k,o()(r.result.Tpo_sys_Functions)),localStorage.setItem(l.l,o()(r.result.Tpo_Sys_Users)),t.menu=r.result.Tpo_Sys_Navigations,t.userInfo=JSON.parse(localStorage.getItem(l.l)));case 5:case"end":return e.stop()}},e,t)}))()},reWriteEmptyUrl:function(t){for(var e in t)""===t[e].Url&&(t[e].Url=Math.random().toString()),t[e].Url.indexOf("Report")>-1&&(t[e].Url=t[e].Url.replace(/http.*key=/,"/Report/")),t[e].ChildNavigations&&this.reWriteEmptyUrl(t[e].ChildNavigations)}},mounted:function(){localStorage.removeItem(l.a),localStorage.removeItem(l.d),localStorage.removeItem(l.e),localStorage.removeItem(l.b),localStorage.removeItem(l.c)},beforeDestroy:function(){clearInterval(this.checkTokenTimer)}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{staticClass:"header"},[a("div",{staticClass:"w_1200 clear",staticStyle:{"max-width":"1200px",width:"100%"}},[a("a",{staticClass:"logo left",attrs:{href:"javascript:;"}}),t._v(" "),a("div",{staticClass:"user right"},[a("el-dropdown",{attrs:{trigger:"hover"},on:{command:t.handleCommands}},[a("span",{staticClass:"el-dropdown-link-2"},[t.CardImgUrl?a("img",{staticClass:"user_icon",attrs:{src:t.CardImgUrl,alt:"头像"}}):t._e(),t._v(" "),a("span",{staticClass:"user_name"},[t._v(t._s(t.TrueName))]),t._v(" "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"logout"}},[t._v("退出")])],1)],1)],1)])]),t._v(" "),t._m(0),t._v(" "),a("div",{staticClass:"contentHome"},[a("transition",{attrs:{name:"fade",mode:"out-in",appear:""}},[a("ul",{staticClass:"console-menu clear"},t._l(t.menu,function(e){return a("li",{key:e.NavigationId,staticClass:"console-menu-items",on:{click:function(a){t.clickRouter(e)}}},[a("span",{staticClass:"item-icon",attrs:{id:e.Iconurl}}),t._v(" "),a("span",{staticClass:"item-title"},[t._v(t._s(e.Title))])])}))])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"banner"},[e("div",{staticClass:"w_1200"},[e("h3",{staticClass:"banner_titt"},[this._v("高顿教育-财经云")]),this._v(" "),e("h4",{staticClass:"banner_titb"},[this._v("提供教学活动和教育资源管理、分析的一体化解决方案")])])])}]};var I=a("Z0/y")(v,g,!1,function(t){a("bc08"),a("oI0u")},null,null);e.default=I.exports},bc08:function(t,e){},oI0u:function(t,e){}});
//# sourceMappingURL=11.9e08c614eecdaa8b1bd7.js.map